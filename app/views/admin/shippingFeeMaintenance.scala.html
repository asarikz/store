@(
  myForm: Form[FeeMaintenance],
  rec: Option[(Site, ShippingBox)],
  list: Seq[(ShippingFee, Option[ShippingFeeHistory])]
)(
  implicit lang: Lang,
  request: RequestHeader,
  loginSession: LoginSession
)

@import helper._

@main(Messages("shippingFeeMaintenanceTitle"), Some(loginSession)) {
  <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
  <link href="@routes.Assets.at("stylesheets/ui-lightness/jquery-ui-1.10.3.custom.min.css")" rel="stylesheet">
  <script src="@routes.Assets.at("javascripts/jquery.ui.datepicker-ja.js")" type="text/javascript"></script>
} {
  <script type="text/javascript">
    $(function() {
      $("#now").datepicker({
        dateFormat: 'yy年mm月dd日'
      });
    });
  </script>
  <h1 class="title">@Messages("shippingFeeMaintenanceTitle")</h1>

  @if(rec.isDefined) {
    <table class="shippingFeeHeader">
      <tr class="header">
        <th class="site">@Messages("site")</th>
        <th class="boxName">@Messages("boxName")</th>
      </tr>
      <tr class="body">
        <td class="site">@rec.get._1.name</td>
        <td class="boxName">@rec.get._2.boxName</td>
      </tr>
    </table>
  }

  @if(myForm.hasErrors) {
    <div class="globalErrorMessage">
      @Messages("inputError")
    </div>
  }

  @helper.form(action = routes.ShippingFeeMaintenance.startFeeMaintenance(), 'id -> "shippingMaintenanceForm") {
    @inputText(myForm("boxId"), 'type -> "hidden", '_showConstraints -> false)(
      helper.FieldConstructor(simpleField.f), implicitly
    )

    @inputText(
      myForm("now"),
      '_label -> Messages("date.query"), 'id -> "now"
    )

    <input type="submit" value="@Messages("update")">
  }

  @if(! list.isEmpty) {
    <table class="shippingFeeList">
      <tr class="header">
        <th class="country">@Messages("country")</th>
        <th class="prefecture">@Messages("prefecture")</th>
        <th class="shippingFee">@Messages("shipping.fee")</th>
      </tr>
      @list.map { e =>
        <tr class="body">
          <td class="country">
            @Messages("country." + e._1.countryCode)
          </td>
          <td class="prefecture">
            @JapanPrefecture.byIndex(e._1.locationCode)
          </td>
          <td class="shippingFee">
            @e._2.map { his => @amount(his.fee) }.getOrElse("-")
          </td>
          <td class="edit">
            <a href="@routes.ShippingFeeMaintenance.editHistory(e._1.id.get)">
              @Messages("edit")
            </a>
          </td>
        </tr>
      }
    </table>
  }

  <div class="menuPanel">
    <a href="@routes.ShippingBoxMaintenance.editShippingBox()">
      @Messages("backTo", Messages("editShippingBoxTitle"))
    </a>
  </div>

  <div class="menuPanel">
    @admin.backToAdminTop()
  </div>
}
